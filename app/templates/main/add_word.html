<!-- add_word.html -->
<!DOCTYPE html>
<html>
<head>
    <title>Add Word</title>
</head>
<body>
    <h1>Add a New Word</h1>
    <form action="{{ url_for('main.add_word') }}" method="post" id="add-form">
        <div class="mb-3">
            <label for="question" class="form-label">Question:</label>
            <input type="text" name="question" class="form-control" id="question" required onInput="checkWordExists('question')">
            <div class="invalid-feedback" id="question-feedback"></div>
        </div>
        <div class="mb-3">
            <label for="answer" class="form-label">Answer:</label>
            <input type="text" name="answer" class="form-control" id="answer" required onInput="checkWordExists('answer')">
            <div class="invalid-feedback" id="answer-feedback"></div>
        </div>
        <button type="submit" class="btn btn-primary" id="submit-btn" disabled>Add</button>
    </form>
    
    <script>
    function checkWordExists(fieldId) {
    const field = document.getElementById(fieldId);
    const feedbackElement = document.getElementById(`${fieldId}-feedback`);
    const submitBtn = document.getElementById('submit-btn');

    fetch(`/check-word?word=${field.value}`)
        .then(response => response.json())
        .then(data => {
            if (data.exists) {
                field.classList.add('is-invalid');
                feedbackElement.textContent = 'Это слово уже существует.';
                submitBtn.disabled = true;
            } else {
                field.classList.remove('is-invalid');
                feedbackElement.textContent = '';
                submitBtn.disabled = false;
            }
        })
        .catch(error => {
            console.error('Error checking word:', error);
            field.classList.remove('is-invalid');
            feedbackElement.textContent = '';
            submitBtn.disabled = false;
        });
}

    
    </script>
</body>
</html>
